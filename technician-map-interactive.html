
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Interactive U.S. Map</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script src="https://unpkg.com/topojson@3"></script>
  <style>
    body {
      margin: 0;
      background: white;
      font-family: 'Segoe UI', sans-serif;
    }
    svg {
      width: 100%;
      height: 100vh;
    }
    .state {
      fill: #cce5ff;
      stroke: #fff;
      stroke-width: 1;
      cursor: pointer;
    }
    .abbreviation {
      fill: #111;
      font-size: 12px;
      font-weight: bold;
      text-anchor: middle;
      pointer-events: none;
    }
    #popup {
      position: absolute;
      background: #fff;
      padding: 1em;
      border-radius: 6px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.15);
      z-index: 10;
      display: none;
      transform: scale(0.8);
      opacity: 0;
      transition: transform 0.25s ease, opacity 0.25s ease;
      max-width: 300px;
    }
    #filter {
      position: absolute;
      top: 10px;
      left: 10px;
      z-index: 20;
      background: white;
      padding: 0.5em 1em;
      border-radius: 6px;
      box-shadow: 0 1px 5px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body>
<div id="filter">
  <label><input type="radio" name="metric" value="techs" checked> # Techs</label>
  <label><input type="radio" name="metric" value="cold"> # Cold</label>
  <label><input type="radio" name="metric" value="hot"> # Hot</label>
</div>
<svg></svg>
<div id="popup"></div>
<script>
const abbreviations = {"Alabama": "AL", "Alaska": "AK", "Arizona": "AZ", "Arkansas": "AR", "California": "CA", "Colorado": "CO", "Connecticut": "CT", "Delaware": "DE", "Florida": "FL", "Georgia": "GA", "Hawaii": "HI", "Idaho": "ID", "Illinois": "IL", "Indiana": "IN", "Iowa": "IA", "Kansas": "KS", "Kentucky": "KY", "Louisiana": "LA", "Maine": "ME", "Maryland": "MD", "Massachusetts": "MA", "Michigan": "MI", "Minnesota": "MN", "Mississippi": "MS", "Missouri": "MO", "Montana": "MT", "Nebraska": "NE", "Nevada": "NV", "New Hampshire": "NH", "New Jersey": "NJ", "New Mexico": "NM", "New York": "NY", "North Carolina": "NC", "North Dakota": "ND", "Ohio": "OH", "Oklahoma": "OK", "Oregon": "OR", "Pennsylvania": "PA", "Rhode Island": "RI", "South Carolina": "SC", "South Dakota": "SD", "Tennessee": "TN", "Texas": "TX", "Utah": "UT", "Vermont": "VT", "Virginia": "VA", "Washington": "WA", "West Virginia": "WV", "Wisconsin": "WI", "Wyoming": "WY"};
const divisionData = {"Washington": [{"division": "WA - 636", "techs": 6, "cold": 6, "hot": 0}, {"division": "WA - 636F", "techs": 0, "cold": 0, "hot": 0}, {"division": "WA - 638", "techs": 6, "cold": 6, "hot": 0}, {"division": " WA - 638F", "techs": 0, "cold": 0, "hot": 0}, {"division": " WA - 641", "techs": 4, "cold": 4, "hot": 0}, {"division": "WA - 641F", "techs": 0, "cold": 0, "hot": 0}], "Idaho": [{"division": "ID - 638", "techs": 6, "cold": 6, "hot": 0}, {"division": " ID - 638F", "techs": 0, "cold": 0, "hot": 0}, {"division": "ID - 631", "techs": 4, "cold": 4, "hot": 0}, {"division": "ID - 631F", "techs": 0, "cold": 0, "hot": 0}, {"division": "ID - 633", "techs": 6, "cold": 6, "hot": 0}, {"division": "ID - 633F", "techs": 0, "cold": 0, "hot": 0}], "Oregon": [{"division": " OR - 641", "techs": 4, "cold": 4, "hot": 0}, {"division": " OR - 641F", "techs": 0, "cold": 0, "hot": 0}], "California": [{"division": "CA - 646", "techs": 14, "cold": 14, "hot": 0}, {"division": "CA - 646F", "techs": 0, "cold": 0, "hot": 0}, {"division": "CA - 650", "techs": 18, "cold": 18, "hot": 0}, {"division": "CA - 650F", "techs": 0, "cold": 0, "hot": 0}, {"division": "CA - 644", "techs": 18, "cold": 17, "hot": 1}, {"division": "CA - 644F", "techs": 0, "cold": 0, "hot": 0}, {"division": "CA - 655", "techs": 12, "cold": 12, "hot": 0}, {"division": "CA - 655F", "techs": 0, "cold": 0, "hot": 0}, {"division": "CA - 661", "techs": 4, "cold": 2, "hot": 2}, {"division": "CA - 661F", "techs": 44, "cold": 14, "hot": 30}], "Nevada": [{"division": "NV - 507", "techs": 6, "cold": 4, "hot": 2}, {"division": "NV - 507F", "techs": 0, "cold": 0, "hot": 0}, {"division": "NV - 606", "techs": 9, "cold": 8, "hot": 1}, {"division": "NV - 606F", "techs": 0, "cold": 0, "hot": 0}], "Arizona": [{"division": "AZ - 606", "techs": 9, "cold": 8, "hot": 1}, {"division": "AZ - 606F", "techs": 0, "cold": 0, "hot": 0}, {"division": "AZ - 502", "techs": 13, "cold": 13, "hot": 0}, {"division": "AZ - 502F", "techs": 0, "cold": 0, "hot": 0}, {"division": "AZ - 504", "techs": 4, "cold": 4, "hot": 0}, {"division": "AZ - 504F", "techs": 0, "cold": 0, "hot": 0}], "Wyoming": [{"division": "WY - 621", "techs": 4, "cold": 4, "hot": 0}, {"division": "WY - 621F", "techs": 0, "cold": 0, "hot": 0}, {"division": "WY - 623", "techs": 6, "cold": 6, "hot": 0}, {"division": "WY - 623F", "techs": 0, "cold": 0, "hot": 0}], "Utah": [{"division": "UT - 516", "techs": 28, "cold": 23, "hot": 5}, {"division": "UT - 516F", "techs": 2, "cold": 0, "hot": 2}, {"division": "UT - 518 ", "techs": 10, "cold": 6, "hot": 4}, {"division": "UT - 518F", "techs": 0, "cold": 0, "hot": 0}], "Colorado": [{"division": "CO - 511", "techs": 9, "cold": 9, "hot": 0}, {"division": "CO - 511F", "techs": 1, "cold": 1, "hot": 0}, {"division": "CO - 513", "techs": 6, "cold": 6, "hot": 0}, {"division": "CO - 513F", "techs": 0, "cold": 0, "hot": 0}], "New Mexico": [{"division": "NM - 416", "techs": 6, "cold": 6, "hot": 0}, {"division": "NM - 416F", "techs": 0, "cold": 0, "hot": 0}, {"division": "NM - 415", "techs": 1, "cold": 1, "hot": 0}, {"division": "NM - 415F", "techs": 1, "cold": 0, "hot": 1}], "Nebraska": [{"division": "NE - 168", "techs": 2, "cold": 2, "hot": 0}, {"division": "NE - 167", "techs": 6, "cold": 6, "hot": 0}], "Kansas": [{"division": "KS - 166", "techs": 25, "cold": 24, "hot": 1}, {"division": "KS - 166F", "techs": 1, "cold": 0, "hot": 1}], "Missouri": [{"division": "MO - 166", "techs": 25, "cold": 24, "hot": 1}, {"division": "MO - 166F", "techs": 1, "cold": 0, "hot": 1}, {"division": "MO - 165", "techs": 29, "cold": 28, "hot": 1}, {"division": "MO - 165F", "techs": 0, "cold": 0, "hot": 0}, {"division": "MO - 401", "techs": 18, "cold": 18, "hot": 0}, {"division": "MO - 401F", "techs": 2, "cold": 1, "hot": 1}], "Illinois": [{"division": "IL - 165", "techs": 29, "cold": 28, "hot": 1}, {"division": "IL - 165F", "techs": 0, "cold": 0, "hot": 0}, {"division": "WI - 162", "techs": 10, "cold": 10, "hot": 0}, {"division": "IL - 163", "techs": 24, "cold": 24, "hot": 0}, {"division": "IL - 163F", "techs": 3, "cold": 2, "hot": 1}, {"division": "IL - 175", "techs": 21, "cold": 21, "hot": 0}, {"division": "IL - 175F", "techs": 0, "cold": 0, "hot": 0}], "Minnesota": [{"division": "MN - 161", "techs": 9, "cold": 9, "hot": 0}, {"division": "MI - 154", "techs": 48, "cold": 48, "hot": 0}], "Iowa": [{"division": "IA - 164", "techs": 7, "cold": 7, "hot": 0}], "Wisconsin": [{"division": "WI - 162F", "techs": 0, "cold": 0, "hot": 0}, {"division": "WI - 155", "techs": 24, "cold": 22, "hot": 2}, {"division": "WI - 155F", "techs": 0, "cold": 0, "hot": 0}], "Oklahoma": [{"division": "OK - 406", "techs": 17, "cold": 17, "hot": 0}, {"division": "OK - 406F", "techs": 1, "cold": 0, "hot": 1}, {"division": "OK - 414", "techs": 14, "cold": 14, "hot": 0}, {"division": "OK - 414F", "techs": 0, "cold": 0, "hot": 0}], "Arkansas": [{"division": "AR - 401", "techs": 18, "cold": 18, "hot": 0}, {"division": "AR - 401F", "techs": 2, "cold": 1, "hot": 1}], "Louisiana": [{"division": "LA - 402", "techs": 37, "cold": 37, "hot": 0}, {"division": "LA - 402F", "techs": 0, "cold": 0, "hot": 0}], "Indiana": [{"division": "IN - 152", "techs": 14, "cold": 14, "hot": 0}, {"division": "IN - 153", "techs": 35, "cold": 35, "hot": 0}], "Ohio": [{"division": "OH - 148", "techs": 16, "cold": 16, "hot": 0}, {"division": "OH - 151", "techs": 16, "cold": 16, "hot": 0}], "Kentucky": [{"division": "KY - 151", "techs": 16, "cold": 16, "hot": 0}, {"division": "KY - 153", "techs": 35, "cold": 35, "hot": 0}], "Tennessee": [{"division": "TN - 109", "techs": 33, "cold": 33, "hot": 0}], "South Carolina": [{"division": "SC - 107", "techs": 23, "cold": 23, "hot": 0}, {"division": "SC - 106", "techs": 47, "cold": 46, "hot": 1}, {"division": "NC - 107", "techs": 23, "cold": 23, "hot": 0}, {"division": "SC - 105", "techs": 15, "cold": 15, "hot": 0}], "North Carolina": [{"division": "NC - 106", "techs": 47, "cold": 46, "hot": 1}, {"division": "NC - 301", "techs": 14, "cold": 10, "hot": 4}, {"division": "NC - 321", "techs": 11, "cold": 11, "hot": 0}, {"division": "NC - 603", "techs": 12, "cold": 12, "hot": 0}], "West Virginia": [{"division": "WV - 306", "techs": 14, "cold": 14, "hot": 0}, {"division": "WV - 307", "techs": 6, "cold": 6, "hot": 0}], "Virginia": [{"division": "VA - 301", "techs": 14, "cold": 10, "hot": 4}, {"division": "VA - 321", "techs": 11, "cold": 11, "hot": 0}, {"division": "VA - 602", "techs": 11, "cold": 11, "hot": 0}, {"division": "VA - 603", "techs": 12, "cold": 12, "hot": 0}], "Texas": [{"division": "TX - 414", "techs": 14, "cold": 14, "hot": 0}, {"division": "TX - 414F", "techs": 0, "cold": 0, "hot": 0}, {"division": "TX - 404", "techs": 24, "cold": 24, "hot": 0}, {"division": "TX - 404F", "techs": 8, "cold": 1, "hot": 7}, {"division": "TX - 412", "techs": 31, "cold": 31, "hot": 0}, {"division": "TX - 412F", "techs": 3, "cold": 0, "hot": 3}, {"division": "TX - 413", "techs": 26, "cold": 26, "hot": 0}, {"division": "TX - 413F", "techs": 0, "cold": 0, "hot": 0}, {"division": "TX - 403", "techs": 22, "cold": 22, "hot": 0}, {"division": "TX - 403F", "techs": 3, "cold": 0, "hot": 3}, {"division": "TX - 405", "techs": 12, "cold": 12, "hot": 0}, {"division": "TX - 405F", "techs": 0, "cold": 0, "hot": 0}, {"division": "TX - 410", "techs": 19, "cold": 19, "hot": 0}, {"division": "TX - 410F", "techs": 2, "cold": 0, "hot": 2}, {"division": "TX - 408", "techs": 25, "cold": 25, "hot": 0}, {"division": "TX - 408F", "techs": 3, "cold": 0, "hot": 3}], "Alabama": [{"division": "AL - 108", "techs": 51, "cold": 51, "hot": 0}], "Mississippi": [{"division": "MS - 110", "techs": 32, "cold": 32, "hot": 0}], "Pennsylvania": [{"division": "PA - 304", "techs": 39, "cold": 39, "hot": 0}, {"division": "RI - 313", "techs": 6, "cold": 6, "hot": 0}], "New York": [{"division": "NY - 308", "techs": 30, "cold": 30, "hot": 0}, {"division": "NY - 691", "techs": 5, "cold": 5, "hot": 0}, {"division": "NY - 692", "techs": 4, "cold": 4, "hot": 0}], "Vermont": [{"division": "VT - 317", "techs": 2, "cold": 2, "hot": 0}], "New Hampshire": [{"division": "NH - 315", "techs": 4, "cold": 4, "hot": 0}], "Maine": [{"division": "ME - 309", "techs": 16, "cold": 16, "hot": 0}], "Massachusetts": [{"division": "MA - 309", "techs": 16, "cold": 16, "hot": 0}], "Rhode Island": [{"division": "CT - 311", "techs": 3, "cold": 3, "hot": 0}], "New Jersey": [{"division": "NJ - 305", "techs": 5, "cold": 5, "hot": 0}], "Delaware": [{"division": "DE - 303", "techs": 17, "cold": 17, "hot": 0}], "Maryland": [{"division": "MD - 302", "techs": 16, "cold": 16, "hot": 0}], "Georgia": [{"division": "GA - 105", "techs": 15, "cold": 15, "hot": 0}, {"division": "GA - 115", "techs": 20, "cold": 20, "hot": 0}, {"division": "GA - 116", "techs": 15, "cold": 15, "hot": 0}, {"division": "GA - 117", "techs": 17, "cold": 17, "hot": 0}], "Florida": [{"division": "FL - 113", "techs": 15, "cold": 15, "hot": 0}, {"division": "FL - 103", "techs": 13, "cold": 13, "hot": 0}, {"division": "FL - 112", "techs": 14, "cold": 13, "hot": 1}, {"division": "FL - 102", "techs": 17, "cold": 17, "hot": 0}, {"division": "FL - 104", "techs": 11, "cold": 11, "hot": 0}, {"division": "FL - 111", "techs": 11, "cold": 11, "hot": 0}, {"division": "FL - 114", "techs": 10, "cold": 10, "hot": 0}, {"division": "FL - 118", "techs": 15, "cold": 15, "hot": 0}, {"division": "FL - 119", "techs": 14, "cold": 14, "hot": 0}, {"division": "FL - 101", "techs": 19, "cold": 19, "hot": 0}, {"division": "FL - 113F", "techs": 19, "cold": 19, "hot": 0}, {"division": "FL - 103F", "techs": 19, "cold": 19, "hot": 0}, {"division": "FL - 112F", "techs": 19, "cold": 19, "hot": 0}, {"division": "FL - 102F", "techs": 19, "cold": 19, "hot": 0}, {"division": "FL - 104F", "techs": 19, "cold": 19, "hot": 0}, {"division": "FL - 111F", "techs": 19, "cold": 19, "hot": 0}, {"division": "FL - 114F", "techs": 19, "cold": 19, "hot": 0}, {"division": "FL - 118F", "techs": 19, "cold": 19, "hot": 0}, {"division": "FL - 119F", "techs": 19, "cold": 19, "hot": 0}, {"division": "FL - 101F", "techs": 19, "cold": 19, "hot": 0}]};

const svg = d3.select("svg");
const g = svg.append("g");

const projection = d3.geoAlbersUsa().scale(1300).translate([487.5, 305]);
const path = d3.geoPath().projection(projection);
const zoom = d3.zoom().on("zoom", (event) => {
  g.attr("transform", event.transform);
});
svg.call(zoom);

d3.json("https://cdn.jsdelivr.net/npm/us-atlas@3/states-10m.json").then(us => {
  const states = topojson.feature(us, us.objects.states).features;

  g.selectAll("path")
    .data(states)
    .enter()
    .append("path")
    .attr("class", "state")
    .attr("d", path)
    .on("click", (event, d) => {
      const name = d.properties.name;
      const abbr = abbreviations[name] || "";
      const metric = document.querySelector("input[name='metric']:checked").value;
      const data = divisionData[name] || [];

      let html = `<h3>${name}</h3><ul>`;
      data.forEach(e => {
        html += `<li><strong>${e.division}:</strong> ${e[metric]}</li>`;
      });
      html += "</ul>";

      const popup = document.getElementById("popup");
      popup.innerHTML = html;
      popup.style.left = (event.pageX + 10) + "px";
      popup.style.top = (event.pageY - 10) + "px";
      popup.style.display = "block";

      // animate from scale 0.8 to 1
      requestAnimationFrame(() => {
        popup.style.opacity = "1";
        popup.style.transform = "scale(1)";
      });
    });

  g.selectAll("text")
    .data(states)
    .enter()
    .append("text")
    .attr("class", "abbreviation")
    .attr("transform", d => "translate(" + path.centroid(d) + ")")
    .text(d => abbreviations[d.properties.name] || "");
});
</script>
</body>
</html>
